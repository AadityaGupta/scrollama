!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.scrollama={})}(this,function(e){"use strict";function n(e){for(var n=e.length,t=[],o=0;o<n;o+=1)t.push(e[o]);return t}function t(e){return document.querySelector(e)}function o(e,t){return void 0===t&&(t=document),n(t.querySelectorAll(e))}e.scrollama=function(){function e(){var e=P[v];F.step={index:v,direction:S,element:e},z.step,"function"==typeof z.step&&(z.step(F.step),F.step=null)}function n(){var e=P[v];F.progress={index:v,progress:b,direction:S,element:e},"function"==typeof z.progress&&(z.progress(F.progress),F.progress=null)}function r(){F.enter={direction:S},"function"==typeof z.enter&&(z.enter(F.enter),F.enter=null)}function i(){F.exit={direction:S},"function"==typeof z.exit&&(z.exit(F.exit),F.exit=null)}function u(e){var n=e.complete,t=e.off,o=Math.floor(n*B);return[o-1,o,o+1].filter(function(e){var n=e>=0,o=e<B,r=P[e].getBoundingClientRect().top-t<0;return n&&o&&r}).pop()||0}function f(t){var o=t.bbox,r=t.off,i=1-(o.bottom-r)/o.height;(v=u({complete:i,off:r}))!==m&&(m=v,e());var f=P[v].getBoundingClientRect();(b=Math.max(0,1-f.bottom/f.height))!==h&&(h=b,n())}function l(){q||(q=!0,M=!1,r())}function c(){M||(M=!0,q=!1,i())}function s(){S=w<y?"up":"down",y=w}function p(){if(L){var e=L.getBoundingClientRect();s();var n=E*C;e.top<n&&e.bottom>n&&f({bbox:e,off:n}),e.top<0&&e.bottom>j.height?l():c(),R=!1}}function d(){R||window.requestAnimationFrame(p),R=!0}function g(){w=window.scrollY,R||d()}function a(){E=window.innerHeight,j=A?A.getBoundingClientRect():null}function x(e){e&&!_?(window.addEventListener("scroll",g,!0),_=!0):e||(window.removeEventListener("scroll",g,!0),_=!1)}var m=-1,v=0,h=0,b=0,w=0,y=0,B=0,C=0,E=0,R=!1,q=!1,M=!0,S=null,j=null,A=null,L=null,P=null,_=!1,z={},F={},H={};return H.setup=function(e){return A=t(e.graphic),L=t(e.text),P=o(e.step),C=1-e.offset,B=P.length,x(!0),a(),g(),p(),H},H.resize=function(){return a(),H},H.enable=function(){return x(!0),H},H.disable=function(){return x(!1),H},H.onStep=function(e){return z.step=e,F.step&&(z.step(F.step),F.step=null),H},H.onProgress=function(e){return z.progress=e,F.progress&&(z.progress(F.progress),F.progress=null),H},H.onEnter=function(e){return z.enter=e,F.enter&&(z.enter(F.enter),F.enter=null),H},H.onExit=function(e){return z.exit=e,F.exit&&(z.exit(F.exit),F.exit=null),H},H},Object.defineProperty(e,"__esModule",{value:!0})});
